---
title: "Willamette River Salmon"
author: "Allison Hacker, Sydney Rilum, Elmera Azadpour"
date: "2/2/2021"
output: 
  html_document:
    theme: paper
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

library(tidyverse)
library(janitor)
library(here)
library(tsibble)
library(lubridate)
library(slider)
library(feasts)
library(patchwork)
```

## Overview {.tabset}

Image w/ caption

Summary: (3-4 sent)

Map of fish ladder location:
<center>
![Map of fish ladder locations. Source: [Columbia Basin Research](http://www.cbr.washington.edu/dart/dartmap)](./images/dartmap.png)

Data Citation:


### Daily Time Series Data

```{r}
# Read in the data and clean up column names
salmon <- read_csv(here("data", "willamette_fish_passage.csv")) %>% 
  clean_names()

salmon_ts <- salmon %>% 
  mutate(date = lubridate::mdy(date)) %>%  #converts date to readable R form
  as_tsibble(key = NULL, index = date)

salmon_ds <- salmon_ts %>% 
  select(date,coho,jack_coho,steelhead)  %>% 
  replace(is.na(.), 0) %>% 
  pivot_longer(cols = coho:steelhead, #pivoted longer to 
  names_to = "species" ,
  values_to = "count")

ggplot(salmon_ds, aes(date, count)) +
  geom_line(aes(color = species)) +
  theme_minimal() +
  labs(x = "Year", y = "Adult fish count") +
  scale_color_discrete(name = "Fish species")
```
**Figure 1.** Time series plot for coho, jack coho, and steelhead salmon species counts at the Willamette Falls fish ladder on the Willamette River in Oregon from years 2001 to 2010. Red line indicates times series counts for Coho, green line for Jack coho and blue line for Steelhead. Data: Oregon Department of Fish and Wildlife. Source: https://www.dfw.state.or.us/fish/fish_counts/willamette%20falls.asp

Major trends: 

- Jack coho adult count is low in comparison to Coho and Steelhead through the time series.

- Steelhead adult count appears to be greatest compared to Coho and Jack coho up until later in the 2009 calendar year. This similar increase occurs later in 2010 as well.

### Seasonplots

```{r}
# Convert salmon data set into a time series data frame (tsibble)
salmon_ts <- salmon %>% 
  mutate(date = lubridate::mdy(date)) %>%  #converts date to readable R form
  as_tsibble(key = NULL, index = date)

# Create seasonplots
coho_season <- salmon_ts %>% 
  gg_season(y = coho) +
  labs(y = "Coho",
       x = "",
       title = "Salmon Seasonplots")

jack_coho_season <- salmon_ts %>% 
  gg_season(y = jack_coho) +
  labs(y = "Jack Coho",
       x = "")

steelhead_season <- salmon_ts %>% 
  gg_season(y = steelhead) +
  labs(y = "Steelhead",
       x = "Month")

# Combine seasonplots into a single compound figure using the `patchwork` package
coho_season / jack_coho_season / steelhead_season &
  theme_light() +
  theme(legend.position = "none") 
```

**Figure 2.** Seasonplots for coho, jack coho, and steelhead salmon species counts at the Willamette Falls fish ladder on the Willamette River in Oregon. Each colored line represents count data for a single year, including the years 2001 to 2010. Data: ???

Major Trends:

- Coho and jack coho salmon are only present from late August to early November, with counts peaking in the month of October.

- Steelhead salmon are present year-round, with counts highest in the spring (from March to June) and lowest in the fall.



### Annual Counts




